

    <!-- Discharge Summary Clinical Document:  7.1.1.5.2.2 Examination Request Details -->

    <!-- This Schematron file validates 7.1.1.5.2.2 Examination Request Details of 7.1.1.5 Diagnostic Investigations section of Discharge Summary body -->

    <!-- Context: ClinicalDocument/component/structuredBody/component[diag_inv]/section/component[im_exam]/section/ -->


    <!-- Status: Last Reviewed:
         Status: Last Updated : 12/03/2012
 -->


    <pattern name="p-e-Discharge_Summary_3A_Examination_Request_Details-errors"
        id="p-e-Discharge_Summary_3A_Examination_Request_Details-errors"
        see="#p-e-Discharge_Summary_3A_Examination_Request_Details-errors">

        <!-- CDA Body Level 3 Data Elements-->

        <!-- Examination Request Details - 0..* -->
        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']">

            <report test="count(cda:act[cda:code/@code='102.16511']) > 1">Error: e-Discharge Summary
                - 7.1.1.5.2.2 Examination Request Details - The 'act' tag shall appear only once.
                Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

            <assert test="@typeCode = 'SUBJ'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - The 'entryRelationship' tag 'typeCode' attribute shall contain the
                value 'SUBJ'. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert test="@inversionInd = 'true'">Error: e-Discharge Summary - 7.1.1.5.2.2
                Examination Request Details - The 'entryRelationship' tag 'inversionInd' attribute
                shall be 'true'. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>


        </rule>

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:act[cda:code/@code = '102.16511']">

            <report test="count(cda:code[@code='102.16511']) > 1">Error: e-Discharge Summary -
                7.1.1.5.2.2 Examination Request Details - The 'code' tag shall appear only once.
                Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

            <assert test="@classCode = 'ACT'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - The 'act' tag 'classCode' attribute shall contain the value 'ACT'.
                Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert test="@moodCode = 'EVN'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - The 'act' tag 'moodCode' attribute shall contain the value 'EVN'.
                Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <report test="count(cda:entryRelationship[cda:act/cda:code/@code='103.16513']) > 1"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Imaging
                Examination Result / Examination Request Details / DICOM Study Identifier" - The
                'entryRelationship' tag shall appear only once. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

            <report
                test="count(cda:entryRelationship[cda:observation/cda:code/@code='103.16514']) > 1"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Examination
                Request Details / Report Identifier" - The 'entryRelationship' tag shall appear only
                once. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

        </rule>

        <rule context="cda:code[@code = '102.16511']">

            <assert test="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:act/cda:code[@code = '102.16511']"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details -
                The "/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:act/cda:code[@code = '102.16511']" - path -
                1 or more tags are missing. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert test="@codeSystem = '1.2.36.1.2001.1001.101'">Error: e-Discharge Summary -
                7.1.1.5.2.2 Examination Request Details - The 'CODE' tag 'codeSystem' attribute
                shall be '1.2.36.1.2001.1001.101'. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert
                test="translate(@codeSystemName, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'NCTIS DATA COMPONENTS'"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - The 'CODE'
                tag 'codeSystemName' attribute shall contain the value 'NCTIS Data Components'.
                Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert
                test="translate(@displayName, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'EXAMINATION REQUEST DETAILS'"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - The 'code'
                tag 'displayName' attribute shall contain the value 'Examination Request Details'.
                Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

        </rule>


        <!--Examination Requested Name 0..*-->
        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship[cda:observation/cda:code/@code = '103.16512']">

            <report test="count(cda:observation[cda:code/@code='103.16512']) > 1">Error: e-Discharge
                Summary - 7.1.1.5.2.2 Examination Request Details - The 'observation' tag shall
                appear only once. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

            <assert test="@typeCode = 'REFR'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details > Examination Requested Name" - The
                'entryRelationship' tag 'typeCode' attribute shall contain the value 'REFR'. Refer
                to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

        </rule>

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship/cda:observation[cda:code/@code = '103.16512']">

            <report test="count(cda:code[@code='103.16512']) > 1">Error: e-Discharge Summary -
                7.1.1.5.2.2 Examination Request Details - The 'code' tag shall appear only once.
                Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

            <assert test="@classCode = 'OBS'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Examination Requested Name" - The
                'observation' tag 'classCode' attribute shall contain the value 'OBS'. Refer to
                section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert test="@moodCode = 'EVN'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Examination Requested Name" - The
                'observation' tag 'moodCode' attribute shall contain the value 'EVN'. Refer to
                section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert test="cda:text">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request
                Details - "Examination Request Details / Examination Requested Name" - The 'text'
                tag is missing. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <report test="count(cda:text) > 1">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Examination Requested Name" - The
                'text' tag shall appear only once. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

        </rule>

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship/cda:observation[cda:code/@code = '103.16512']/cda:text">

            <assert test="normalize-space(.) !=  ''">Error: e-Discharge Summary - 7.1.1.5.2.2
                Examination Request Details - "Examination Request Details / Examination Requested
                Name" - The 'text' tag shall contain a value. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>


            <!-- Start Mantis Task 2782 -->
            <assert test="@xsi:type">
                Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Examination Requested Name" - The 'text' tag 'xsi:type' attribute is missing.
                Refer to section
                7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.
            </assert>

            <assert test="not(@xsi:type) or normalize-space(@xsi:type) !=  ''">
                Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Examination Requested Name" - The 'text' tag 'xsi:type' attribute shall contain a value.
                Refer to section
                7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.
            </assert>

            <assert test="normalize-space(@xsi:type) = 'ST'">
                Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Examination Requested Name" - The 'text' tag 'xsi:type' attribute shall contain the value 'ST'.
                Refer to section
                7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4. </assert>
            <!-- End Mantis Task 2782 -->

            <!--<assert test="@xsi:type = 'ST'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Examination Requested Name" - The
                'text' tag 'xsi:type' attribute shall contain the value 'ST'. Refer to section
                7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>-->

        </rule>

        <rule context="cda:code[@code = '103.16512']">

            <assert test="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship/cda:observation/cda:code[@code = '103.16512']"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Examination Request Details / Examination Requested Name" -
                The "/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship/cda:observation/cda:code[@code = '103.16512']" path -
                1 or more tags are missing. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert test="@codeSystem = '1.2.36.1.2001.1001.101'">Error: e-Discharge Summary -
                7.1.1.5.2.2 Examination Request Details - "Examination Request Details / Examination
                Requested Name" - The 'code' tag 'codeSystem' attribute shall be
                '1.2.36.1.2001.1001.101'. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert
                test="translate(@codeSystemName, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'NCTIS DATA COMPONENTS'"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Examination
                Request Details / Examination Requested Name" - The 'code' tag 'codeSystemName'
                attribute shall contain the value 'NCTIS Data Components'. Refer to section
                7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert
                test="translate(@displayName, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'EXAMINATION REQUESTED NAME'"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Examination
                Request Details / Examination Requested Name" - The 'code' tag 'displayName'
                attribute shall contain the value 'Examination Requested Name'. Refer to section
                7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

        </rule>


        <!-- DICOM Study Identifier - 0..1 -->
        <!--
        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act[cda:entryRelationship/cda:act/cda:code/@code = '103.16513']">

            <report test="count(cda:entryRelationship[cda:act/cda:code/@code='103.16513']) > 1"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Imaging
                Examination Result / Examination Request Details / DICOM Study Identifier" - The
                'entryRelationship' tag shall appear only once. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

        </rule>-->

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship[cda:act/cda:code/@code = '103.16513']">

            <report test="count(cda:act[cda:code/@code='103.16513']) > 1">Error: e-Discharge Summary
                - 7.1.1.5.2.2 Examination Request Details - "Imaging Examination Result /
                Examination Request Details / DICOM Study Identifier" - The 'act' tag shall appear
                only once. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

            <assert test="@typeCode = 'SUBJ'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Imaging Examination Result / Examination Request Details / DICOM
                Study Identifier" - The 'entryRelationship' tag 'typeCode' attribute shall be
                'SUBJ'. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

        </rule>

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship/cda:act[cda:code/@code = '103.16513']">

            <report test="count(cda:code[@code='103.16513']) > 1">Error: e-Discharge Summary -
                7.1.1.5.2.2 Examination Request Details - "Imaging Examination Result / Examination
                Request Details / DICOM Study Identifier" - The 'code' tag shall appear only once.
                Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

            <assert test="@classCode = 'ACT'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Imaging Examination Result / Examination Request Details / DICOM
                Study Identifier" - The 'act' tag 'classCode' attribute shall contain the value
                'ACT'. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert test="@moodCode = 'EVN'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Imaging Examination Result / Examination Request Details / DICOM
                Study Identifier" - The 'act' tag 'moodCode' attribute shall contain the value
                'EVN'. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert test="cda:id">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request
                Details - "Imaging Examination Result / Examination Request Details / DICOM Study
                Identifier" - The 'id' tag is missing. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <report test="count(cda:id) > 1">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Imaging Examination Result / Examination Request Details / DICOM
                Study Identifier" - The 'id' tag shall appear only once. Refer to section
                7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

            <!--id tag attributes shall be validated by e-e-Discharge_Summary_Global_Checks.sch/ent file-->

        </rule>

        <rule context="cda:code[@code = '103.16513']">

            <assert test="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship/cda:act/cda:code[@code = '103.16513']"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Imaging Examination Result / Examination Request Details / DICOM Study Identifier" -
                The "/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship/cda:act/cda:code[@code = '103.16513']" path -
                1 or more tags are missing. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert test="@codeSystem = '1.2.36.1.2001.1001.101'">Error: e-Discharge Summary -
                7.1.1.5.2.2 Examination Request Details - "Imaging Examination Result / Examination
                Request Details / DICOM Study Identifier" - The 'code' tag 'codeSystem' attribute
                shall be '1.2.36.1.2001.1001.101'. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert
                test="translate(@codeSystemName, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'NCTIS DATA COMPONENTS'"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Imaging
                Examination Result / Examination Request Details / DICOM Study Identifier" - The
                'code' tag 'codeSystemName' attribute shall contain the value 'NCTIS Data
                Components'. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert
                test="translate(@displayName, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'DICOM STUDY IDENTIFIER'"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Imaging
                Examination Result / Examination Request Details / DICOM Study Identifier" - The
                'code' tag 'displayName' attribute shall contain the value 'DICOM Study Identifier'.
                Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

        </rule>

        <!-- Report Identifier - 0..1 -->

        <!--
        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act[cda:entryRelationship/cda:observation/cda:code/@code = '103.16514']">

            <report
                test="count(cda:entryRelationship[cda:observation/cda:code/@code='103.16514']) > 1"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Examination
                Request Details / Report Identifier" - The 'entryRelationship' tag shall appear only
                once. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

        </rule>-->


        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship[cda:observation/cda:code/@code = '103.16514']">

            <report test="count(cda:observation[cda:code/@code='103.16514']) > 1">Error: e-Discharge
                Summary - 7.1.1.5.2.2 Examination Request Details - "Examination Request Details /
                Report Identifier" - The 'observation' tag shall appear only once. Refer to section
                7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

            <assert test="@typeCode = 'COMP'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Report Identifier" - The
                'entryRelationship' tag 'typeCode' attribute shall contain the value 'COMP'. Refer
                to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

        </rule>

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship/cda:observation[cda:code/@code = '103.16514']">

            <report test="count(cda:code[@code='103.16514']) > 1">Error: e-Discharge Summary -
                7.1.1.5.2.2 Examination Request Details - "Examination Request Details / Report
                Identifier" - The 'code' tag shall appear only once. Refer to section 7.1.1.5.2.2 of
                the e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>


            <assert test="@classCode = 'OBS'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Report Identifier" - The
                'observation' tag 'classCode' attribute shall contain the value 'OBS'. Refer to
                section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert test="@moodCode = 'EVN'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Report Identifier" - The
                'observation' tag 'moodCode' attribute shall contain the value 'EVN'. Refer to
                section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert test="cda:id">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request
                Details - "Examination Request Details / Report Identifier" - The 'id' tag is
                missing. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <report test="count(cda:id) > 1">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Report Identifier" - The 'id' tag
                shall appear only once. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

            <!--id tag attributes shall be validated by e-e-Discharge_Summary_Global_Checks.sch/ent file-->



        </rule>

        <rule context="cda:code[@code = '103.16514']">

            <assert test="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship/cda:observation/cda:code[@code = '103.16514']"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Examination Request Details / Report Identifier" -
                The "/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship/cda:observation/cda:code[@code = '103.16514']" path -
                1 or more tags are missing. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert test="@codeSystem = '1.2.36.1.2001.1001.101'">Error: e-Discharge Summary -
                7.1.1.5.2.2 Examination Request Details - "Examination Request Details / Report
                Identifier" - The 'code' tag 'codeSystem' attribute shall be
                '1.2.36.1.2001.1001.101'. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert
                test="translate(@codeSystemName, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'NCTIS DATA COMPONENTS'"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Examination
                Request Details / Report Identifier" - The 'code' tag 'codeSystemName' attribute
                shall be 'NCTIS Data Components'. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert
                test="translate(@displayName, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'REPORT IDENTIFIER'"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Examination
                Request Details / Report Identifier" - The 'code' tag 'displayName' attribute shall
                be 'Report Identifier'. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

        </rule>


        <!--Need to work..................................................................................................-->


        <!-- Image Details - 0..* -->
        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship[cda:act/cda:code/@code = '103.16513']/cda:act/cda:entryRelationship[cda:observation/cda:code/@code = '103.16515']">

            <assert test="@typeCode = 'COMP'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Image Details" - The
                'entryRelationship' tag 'typeCode' attribute shall contain the value 'COMP'. Refer
                to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

        </rule>

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship[cda:act/cda:code/@code = '103.16513']/cda:act/cda:entryRelationship/cda:observation[cda:code/@code = '103.16515']">

            <assert test="@classCode = 'OBS'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Image Details" - The 'observation'
                tag 'classCode' attribute shall contain the value 'OBS'. Refer to section
                7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert test="@moodCode = 'EVN'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Image Details" - The 'act' tag
                'moodCode' attribute shall contain the value 'EVN'. Refer to section 7.1.1.5.2.2 of
                the e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <!-- Image Identifier - 0..1 -->

            <assert test="cda:id">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request
                Details - "Examination Request Details / Image Details / Image Identifier" - The
                'id' tag is missing. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <report test="count(cda:id) > 1">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Image Details / Image Identifier" -
                The 'id' tag shall appear only once. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

            <!--id tag attributes shall be validated by e-e-Discharge_Summary_Global_Checks.sch/ent file-->

            <!-- Image View Name - 0..1 -->

            <!-- Removed SY 23/02/2012 ID:2163 -->
            <!--<assert test="cda:value">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request
                Details - "Examination Request Details / Image Details / Image View Name" - The
                'value' tag is missing. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>-->
            <!-- End of SY's Remove ID:1630 -->

            <report test="count(cda:value) > 1">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Image Details / Image View Name" -
                The 'value' tag shall appear only once. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

        </rule>

        <!-- Image Details - 0..* (Continued) -->
        <rule context="cda:code[@code = '103.16515']">

            <assert test="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship[cda:act/cda:code/@code = '103.16513']/cda:act/cda:entryRelationship/cda:observation/cda:code[@code = '103.16515']"
                >Error: e-Discharge Summary -  7.1.1.5.2.2 Examination Request Details - "Examination Request Details / Image Details" -
                The "/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship[cda:act/cda:code/@code = '103.16513']/cda:act/cda:entryRelationship/cda:observation/cda:code[@code = '103.16515']" path -
                1 or more tags are missing. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert test="@codeSystem = '1.2.36.1.2001.1001.101'">Error: e-Discharge Summary -
                7.1.1.5.2.2 Examination Request Details - "Examination Request Details / Image
                Details" - The 'code' tag 'codeSystem' attribute shall contain the value
                '1.2.36.1.2001.1001.101'. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert
                test="translate(@codeSystemName, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'NCTIS DATA COMPONENTS'"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Examination
                Request Details / Image Details" - The 'code' tag 'codeSystemName' attribute shall
                be 'NCTIS Data Components'. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert
                test="translate(@displayName, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'IMAGE DETAILS'"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Examination
                Request Details / Image Details" - The 'code' tag 'displayName' attribute shall be
                'Image Details'. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

        </rule>

        <!-- Image View Name > value tags - attributes - 0..1 -->
        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship[cda:act/cda:code/@code = '103.16513']/cda:act/cda:entryRelationship/cda:observation[cda:code/@code = '103.16515']/cda:value">

            <assert
                test="cda:originalText or cda:translation or (@code and @codeSystem) or @nullFlavor"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - The 'value'
                tag shall have 'originalText' or 'translation' tag or 'code and codeSystem' or
                'nullFlavor' attribute. Refer to section 8.1 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <report test="@code and normalize-space(@code) = ''">Error: e-Discharge Summary -
                7.1.1.5.2.2 Examination Request Details - "Examination Request Details / Image
                Details / Image View Name" - The 'code' tag 'code' attribute shall contain a value.
                Refer to sections 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

            <report test="@codeSystem and normalize-space(@codeSystem) = ''">Error: e-Discharge
                Summary - 7.1.1.5.2.2 Examination Request Details - "Examination Request Details /
                Image Details / Image View Name" - The 'code' tag 'codeSystem' attribute shall
                contain a value. Refer to sections 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

            <report test="@codeSystemName and normalize-space(@codeSystemName) = ''">Error:
                e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Examination Request
                Details / Image Details / Image View Name" - The 'code' tag 'codeSystemName'
                attribute shall contain a value. Refer to sections 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

            <report test="@displayName and normalize-space(@displayName) = ''">Error: e-Discharge
                Summary - 7.1.1.5.2.2 Examination Request Details - "Examination Request Details /
                Image Details / Image View Name" - The 'code' tag 'displayName' attribute shall
                contain a value. Refer to sections 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

            <report test="cda:originalText and normalize-space(cda:originalText) = ''">Error:
                e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Examination Request
                Details / Image Details / Image View Name" - The 'originalText' tag shall contain a
                value. Refer to sections 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

            <report test="count(cda:originalText) > 1">Error:
                e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Examination Request
                Details / Image Details / Image View Name" - The 'originalText' tag shall appear only once. Refer to sections 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

            <report test="cda:translation and normalize-space(cda:translation) = ''">Error:
                e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Examination Request
                Details / Image Details / Image View Name" - The 'translation' tag
                shall contain a value. Refer to sections 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>


        </rule>


        <!--DICOM Series Identifier - 0..1-->
        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship[cda:act/cda:code/@code = '103.16513']/cda:act/cda:entryRelationship/cda:observation[cda:code/@code = '103.16515']/cda:entryRelationship[cda:act/cda:code/@code = '103.16517']">

            <assert test="@typeCode = 'REFR'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Imaging Examination Result / Examination Request Details / Image
                Details / DICOM Series Identifier" - The 'entryRelationship' tag 'typeCode'
                attribute shall contain the value 'REFR'. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <report test="count(cda:act) > 1">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Imaging Examination Result / Examination Request Details / Image
                Details / DICOM Series Identifier" - The 'act' tag shall appear only once. Refer to
                section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

        </rule>

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship[cda:act/cda:code/@code = '103.16513']/cda:act/cda:entryRelationship/cda:observation[cda:code/@code = '103.16515']/cda:entryRelationship/cda:act[cda:code/@code = '103.16517']">

            <assert test="@classCode = 'ACT'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Imaging Examination Result / Examination Request Details / Image
                Details / DICOM Series Identifier" - The 'act' tag 'classCode' attribute shall
                contain the value 'ACT'. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert test="@moodCode = 'EVN'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Imaging Examination Result / Examination Request Details / Image
                Details / DICOM Series Identifier" - The 'act' tag 'moodCode' attribute shall be
                'EVN'. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert test="cda:id">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request
                Details - "Examination Request Details / Image Details / DICOM Series Identifier" -
                The 'id' tag is missing. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <report test="count(cda:id) > 1">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Image Details / DICOM Series
                Identifier" - The 'id' tag shall appear once. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

            <!--id tag attributes shall be validated by e-e-Discharge_Summary_Global_Checks.sch/ent file-->

            <report test="count(cda:code) > 1">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Imaging Examination Result /Examination Request Details / Image
                Details / DICOM Series Identifier" - The 'code' tag shall appear once. Refer to
                section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

        </rule>

        <rule context="cda:code[@code = '103.16517']">

            <assert test="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship[cda:act/cda:code/@code = '103.16513']/cda:act/cda:entryRelationship/cda:observation[cda:code/@code = '103.16515']/cda:entryRelationship/cda:act/cda:code[@code = '103.16517']"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Imaging Examination Result / Examination Request Details / Image Details / DICOM Series Identifier" -
                The "/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship[cda:act/cda:code/@code = '103.16513']/cda:act/cda:entryRelationship/cda:observation[cda:code/@code = '103.16515']/cda:entryRelationship/cda:act/cda:code[@code = '103.16517']" path -
                1 or more tags are missing. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert test="@codeSystem = '1.2.36.1.2001.1001.101'">Error: e-Discharge Summary -
                7.1.1.5.2.2 Examination Request Details - "Imaging Examination Result / Examination
                Request Details / Image Details / DICOM Series Identifier" - The 'code' tag
                'codeSystem' attribute shall contain the value '1.2.36.1.2001.1001.101'. Refer to
                section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert
                test="translate(@codeSystemName, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'NCTIS DATA COMPONENTS'"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Imaging
                Examination Result / Examination Request Details / Image Details / DICOM Series
                Identifier" - The 'code' tag 'codeSystemName' attribute shall contain the value
                'NCTIS Data Components'. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert
                test="translate(@displayName, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'DICOM SERIES IDENTIFIER'"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Imaging
                Examination Result / Examination Request Details / Image Details / DICOM Series
                Identifier" - The 'code' tag 'displayName' attribute shall contain the value 'DICOM
                Series Identifier'. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

        </rule>


        <!--Subject Position - 0..1-->
        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship[cda:act/cda:code/@code = '103.16513']/cda:act/cda:entryRelationship/cda:observation[cda:code/@code = '103.16515']/cda:entryRelationship[cda:observation/cda:code/@code = '103.16519']">

            <assert test="@typeCode = 'REFR'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Image Details / Subject Position" -
                The 'entryRelationship' tag 'typeCode' attribute shall contain the value 'SUBJ'.
                Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <report test="count(cda:observation) > 1">Error: e-Discharge Summary - 7.1.1.5.2.2
                Examination Request Details - "Examination Request Details / Image Details / Subject
                Position" - The 'observation' tag shall appear only once. Refer to section
                7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

        </rule>

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship[cda:act/cda:code/@code = '103.16513']/cda:act/cda:entryRelationship/cda:observation[cda:code/@code = '103.16515']/cda:entryRelationship/cda:observation[cda:code/@code = '103.16519']">

            <assert test="@classCode = 'OBS'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Image Details / Subject Position" -
                The 'act' tag 'classCode' attribute shall contain the value 'ACT'. Refer to section
                7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert test="@moodCode = 'EVN'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Image Details / Subject Position" -
                The 'act' tag 'moodCode' attribute shall contain the value 'EVN'. Refer to section
                7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <report test="count(cda:code) > 1">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Image Details / Subject Position" -
                The 'code' tag shall appear once. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

            <assert test="cda:value">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request
                Details - "Examination Request Details / Image Details / Subject Position" - The
                'value' tag is missing. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <report test="count(cda:value) > 1">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Image Details / Subject Position" -
                The 'value' tag shall appear once. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

        </rule>

        <rule context="cda:code[@code = '103.16519']">

            <assert test="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship[cda:act/cda:code/@code = '103.16513']/cda:act/cda:entryRelationship/cda:observation[cda:code/@code = '103.16515']/cda:entryRelationship/cda:observation[cda:code/@code = '103.16519']"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Examination Request Details / Image Details / Subject Position" -
                The "/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship[cda:act/cda:code/@code = '103.16513']/cda:act/cda:entryRelationship/cda:observation[cda:code/@code = '103.16515']/cda:entryRelationship/cda:observation[cda:code/@code = '103.16519']" path -
                1 or more tags are missing. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert test="@codeSystem = '1.2.36.1.2001.1001.101'">Error: e-Discharge Summary -
                7.1.1.5.2.2 Examination Request Details - "Examination Request Details / Image
                Details / Subject Position" - The 'code' tag 'codeSystem' attribute shall be
                '1.2.36.1.2001.1001.101'. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert
                test="translate(@codeSystemName, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'NCTIS DATA COMPONENTS'"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Examination
                Request Details / Image Details / Subject Position" - The 'code' tag
                'codeSystemName' attribute shall contain the value 'NCTIS Data Components'. Refer to
                section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert
                test="translate(@displayName, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'SUBJECT POSITION'"
                >Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request Details - "Examination
                Request Details / Image Details / Subject Position" - The 'code' tag 'displayName'
                attribute shall contain the value 'Subject Position'. Refer to section 7.1.1.5.2.2
                of the e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

        </rule>

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship[cda:act/cda:code/@code = '103.16513']/cda:act/cda:entryRelationship/cda:observation[cda:code/@code = '103.16515']/cda:entryRelationship/cda:observation[cda:code/@code = '103.16519']/cda:value">

            <assert test="@xsi:type">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request
                Details - "Examination Request Details / Image Details / Subject Position" - The
                'value' tag 'xsi:type' attribute is missing. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <!-- Start Mantis Task 2782 -->
            <assert test="not(@xsi:type) or normalize-space(@xsi:type) !=  ''">
                Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Image Details / Subject Position" - The 'value' tag 'xsi:type' attribute shall contain a value.
                Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.
            </assert>

            <assert test="normalize-space(@xsi:type) = 'ST'">
                Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Image Details / Subject Position" - The 'value' tag 'xsi:type' attribute shall contain the value 'ST'.
                Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.
            </assert>


            <!--<assert test="@xsi:type =  'ST'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Image Details / Subject Position" -
                The 'value' tag 'xsi:type' attribute shall contain the value 'ST'. Refer to section
                7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>-->

            <!-- End Mantis Task 2782 -->

        </rule>


        <!-- Image - 0..1 -->
        <!-- NOTE:  '103.16515'  used instead of '103.16519'
                           to get the correct "rule context"  to go to  <entryRelationship typeCode = "SPRT"> -->
        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship[cda:act/cda:code/@code = '103.16513']/cda:act/cda:entryRelationship/cda:observation[cda:code/@code = '103.16515']/cda:entryRelationship[translate(@typeCode, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'SPRT']">

            <assert test="cda:observationMedia">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Image Details / Image" - The
                'observationMedia' tag is missing. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <report test="count(cda:observationMedia) > 1">Error: e-Discharge Summary - 7.1.1.5.2.2
                Examination Request Details - "Examination Request Details / Image Details / Image"
                - The 'observationMedia' tag shall appear once. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

        </rule>

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship[cda:act/cda:code/@code = '103.16513']/cda:act/cda:entryRelationship/cda:observation[cda:code/@code = '103.16515']/cda:entryRelationship[translate(@typeCode, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'SPRT']/cda:observationMedia">

            <assert test="@classCode = 'OBS'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Image Details / Image" - The
                'observationMedia' tag 'classCode' attribute shall contain the value 'OBS'. Refer to
                section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert test="@moodCode = 'EVN'">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Image Details / Image" - The
                'moodCode' attribute shall contain the value 'EVN'. Refer to section 7.1.1.5.2.2 of
                the e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <assert test="cda:id">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request
                Details - "Examination Request Details / Image Details / Image" - The 'id' tag is
                missing. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <report test="count(cda:id) > 1">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination
                Request Details - "Examination Request Details / Image Details / Image" - The 'id'
                tag shall appear only once. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</report>

            <!--id tag attributes shall be validated by e-e-Discharge_Summary_Global_Checks.sch/ent file-->

            <assert test="cda:value">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request
                Details - "Examination Request Details / Image Details / Image" - The 'value' tag is
                missing. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

        </rule>

        <!--Below rule removed as per Mantis 2308-->

        <!--
        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.16006']/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16145']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:act/cda:code/@code = '102.16511']/cda:act/cda:entryRelationship/cda:act/cda:entryRelationship/cda:observation[cda:code/@code = '103.16515']/cda:entryRelationship[translate(@typeCode, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'SPRT']/cda:observationMedia/cda:value">

            <assert test="@xsi:type">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request
                Details - "Examination Request Details / Image Details / Image" -
                The 'value' tag 'xsi:type' attribute is missing. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>

            <!-\-
            <assert test="@xsi:type">Error: e-Discharge Summary - 7.1.1.5.2.2 Examination Request
                Details - "Examination Request Details / Image Details / Subject Position" - The
                'value' tag 'xsi:type' attribute is missing. Refer to section 7.1.1.5.2.2 of the
                e-Discharge_Summary_CDA_Implementation_Guide_v3.4.</assert>-\->

            <!-\-Updated NG 27/02/2012 ID:2433-\->

        </rule>-->

    </pattern>

