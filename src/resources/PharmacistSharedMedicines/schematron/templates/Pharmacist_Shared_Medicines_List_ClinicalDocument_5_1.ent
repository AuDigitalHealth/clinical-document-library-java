<!--
_________________________________________________________________________________________________________________________________________________________________________________________
                  Generated File - Do Not Edit File Directly                                                                                                                             
                  __________________________________________

                  Generated          : 1/11/2018 9:46:46 AM

                  Product            : Pharmacist Shared Medicines List
                  Release            : CDA_Implementation_Guide_v1.0
                  IG Guide Reference : 5.1
                  IG Guide Title     : Clinical Document
                  Generator Version  : 2.28
                                                                                                                                                                                         
_________________________________________________________________________________________________________________________________________________________________________________________
-->
<pattern name="p-Pharmacist_Shared_Medicines_List_ClinicalDocument_5_1-errors"
  id="p-Pharmacist_Shared_Medicines_List_ClinicalDocument_5_1-errors"
  see="#p-Pharmacist_Shared_Medicines_List_ClinicalDocument_5_1-errors">


  <rule context="/">

    <assert test="cda:ClinicalDocument"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument" -
      The 'ClinicalDocument' tag is missing.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <report test="count(cda:ClinicalDocument) > 1"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument" -
      The 'ClinicalDocument' tag shall appear only once.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </report>

  </rule>


  <rule context="/cda:ClinicalDocument">

    <assert test="cda:typeId"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/typeId" -
      The 'typeId' tag is missing.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <report test="count(cda:typeId) > 1"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/typeId" -
      The 'typeId' tag shall appear only once.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </report>

    <assert test="cda:id"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument / Document Instance Identifier" -
      The 'id' tag is missing.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <report test="count(cda:id) > 1"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument / Document Instance Identifier" -
      The 'id' tag shall appear only once.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </report>

    <assert test="cda:code"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument / Document Type" -
      The 'code' tag is missing.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <report test="count(cda:code) > 1"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument / Document Type" -
      The 'code' tag shall appear only once.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </report>

    <assert test="cda:effectiveTime"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/effectiveTime" -
      The 'effectiveTime' tag is missing.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <report test="count(cda:effectiveTime) > 1"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/effectiveTime" -
      The 'effectiveTime' tag shall appear only once.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </report>

    <assert test="cda:confidentialityCode"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/confidentialityCode" -
      The 'confidentialityCode' tag is missing.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <report test="count(cda:confidentialityCode) > 1"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/confidentialityCode" -
      The 'confidentialityCode' tag shall appear only once.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </report>

    <report test="count(cda:languageCode) > 1"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/languageCode" -
      The 'languageCode' tag shall appear only once.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </report>

    <assert test="ext:completionCode"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/ext:completionCode" -
      The 'completionCode' tag is missing.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <report test="count(ext:completionCode) > 1"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/ext:completionCode" -
      The 'completionCode' tag shall appear only once.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </report>

    <report test="count(cda:setId) > 1"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/setId" -
      The 'setId' tag shall appear only once.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </report>

    <report test="count(cda:versionNumber) > 1"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/versionNumber" -
      The 'versionNumber' tag shall appear only once.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </report>

    <report test="count(cda:title) > 1"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument / Document Title" -
      The 'title' tag shall appear only once.
      Refer to section "027999 - Document type" of the
      Pharmacist_Shared_Medicines_List_Conformance_Profile and section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </report>

    <assert test="cda:title"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument / Document Title" -
      The 'title' tag is missing.
      Refer to section "027999 Document type" of the
      Pharmacist_Shared_Medicines_List_Conformance_Profile and section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <report test="cda:title and normalize-space(cda:title) = ''"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument / Document Title" -
      The 'title' tag shall contain a value.
      Refer to section "027999 Document type" of the
      Pharmacist_Shared_Medicines_List_Conformance_Profile and section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </report>

    <report test="
                cda:title and normalize-space(cda:title) != '' and
                cda:title != 'Pharmacist Shared Medicines List'"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument / Document Title" -
      The 'title' tag shall contain the value 'Pharmacist Shared Medicines List'.
      Refer to section "027999 Document type" of the
      Pharmacist_Shared_Medicines_List_Conformance_Profile and section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </report>

  </rule>


  <rule context="/cda:ClinicalDocument/cda:typeId">

    <assert test="@root"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/typeId" -
      The 'typeId' tag 'root' attribute is missing.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <assert test="not(@root) or normalize-space(@root) != ''"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/typeId" -
      The 'typeId' tag 'root' attribute shall contain a value.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <assert test="
                not(@root) or normalize-space(@root) = '' or @root = '2.16.840.1.113883.1.3'"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/typeId" -
      The 'typeId' tag 'root' attribute shall contain the value '2.16.840.1.113883.1.3'.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <assert test="@extension"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/typeId" -
      The 'typeId' tag 'extension' attribute is missing.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <assert test="not(@extension) or normalize-space(@extension) != ''"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/typeId" -
      The 'typeId' tag 'extension' attribute shall contain a value.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <assert test="
                not(@extension) or normalize-space(@extension) = '' or @extension = 'POCD_HD000040'"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/typeId" -
      The 'typeId' tag 'extension' attribute shall contain the value 'POCD_HD000040'.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

  </rule>


  <rule context="/cda:ClinicalDocument/cda:id">

    <assert test="not(@nullFlavor)"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument / Document Instance Identifier" -
      The 'id' tag 'nullFlavor' attribute shall not be present.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

  </rule>


  <rule context="/cda:ClinicalDocument/cda:code">

    <assert test="not(@nullFlavor)"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument / Document Type" -
      The 'code' tag 'nullFlavor' attribute shall not be present.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <assert test="@code"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument / Document Type" -
      The 'code' tag 'code' attribute is missing.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <assert test="
                not(@code) or normalize-space(@code) = '' or @code = '56445-0'"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument / Document Type" -
      The 'code' tag 'code' attribute shall contain the value '56445-0'.
      Refer to section "027999 - Document type" of the
      Pharmacist_Shared_Medicines_List_Conformance_Profile and section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <assert test="@codeSystem"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument / Document Type" -
      The 'code' tag 'codeSystem' attribute is missing.
      Refer to section "027999 - Document type" of the
      Pharmacist_Shared_Medicines_List_Conformance_Profile and section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <assert test="
                not(@codeSystem) or normalize-space(@codeSystem) = '' or @codeSystem = '2.16.840.1.113883.6.1'"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument / Document Type" -
      The 'code' tag 'codeSystem' attribute shall contain the value '2.16.840.1.113883.6.1'.
      Refer to section "027999 - Document type" of the
      Pharmacist_Shared_Medicines_List_Conformance_Profile and section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

  </rule>


  <rule context="/cda:ClinicalDocument/cda:confidentialityCode">

    <assert test="@nullFlavor"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/confidentialityCode" -
      The 'confidentialityCode' tag 'nullFlavor' attribute is missing.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <assert test="not(@nullFlavor) or normalize-space(@nullFlavor) != ''"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/confidentialityCode" -
      The 'confidentialityCode' tag 'nullFlavor' attribute shall contain a value.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <assert test="
                not(@nullFlavor) or normalize-space(@nullFlavor) = '' or @nullFlavor = 'NA'"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/confidentialityCode" -
      The 'confidentialityCode' tag 'nullFlavor' attribute shall contain the value 'NA'.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

  </rule>


  <rule context="/cda:ClinicalDocument/cda:languageCode">

    <assert test="@code"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/languageCode" -
      The 'languageCode' tag 'code' attribute is missing.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <assert test="not(@code) or normalize-space(@code) != ''"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/languageCode" -
      The 'languageCode' tag 'code' attribute shall contain a value.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

  </rule>


  <rule context="/cda:ClinicalDocument/ext:completionCode">

    <assert test="@code"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/ext:completionCode" -
      The 'completionCode' tag 'code' attribute is missing.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <assert test="not(@code) or normalize-space(@code) != ''"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/ext:completionCode" -
      The 'completionCode' tag 'code' attribute shall contain a value.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <assert test="not(@code) or normalize-space(@code) = '' or
                document('TEMPLATE/VALDN/CDAValidate_Vocabs.xml', .)/systems/system[@codeSystemName = 'NCTIS_Document_Status_Values']/code[(@code = current()/@code)]"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/ext:completionCode" -
      The 'completionCode' tag 'code' attribute shall be as per NCTIS: Admin Codes - Document
      Status.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <assert test="@codeSystem"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/ext:completionCode" -
      The 'completionCode' tag 'codeSystem' attribute is missing.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <assert test="not(@codeSystem) or normalize-space(@codeSystem) != ''"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/ext:completionCode" -
      The 'completionCode' tag 'codeSystem' attribute shall contain a value.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <assert test="
                not(@codeSystem) or normalize-space(@codeSystem) = '' or @codeSystem = '1.2.36.1.2001.1001.101.104.20104'"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/ext:completionCode" -
      The 'completionCode' tag 'codeSystem' attribute shall contain the value
      '1.2.36.1.2001.1001.101.104.20104'.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <report test="@displayName and normalize-space(@displayName) = ''"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/ext:completionCode" -
      The 'completionCode' tag 'displayName' attribute shall contain a value.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </report>

    <report test="@code and normalize-space(@code) != '' and
                @displayName and normalize-space(@displayName) != '' and
                not(document('TEMPLATE/VALDN/CDAValidate_Vocabs.xml', .)/systems/system [@codeSystemName = 'NCTIS_Document_Status_Values']/code[
                    (@code = current()/@code) and (
                    translate(@displayName,  'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') =
                    translate(current()/@displayName, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'))])"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/ext:completionCode" -
      The 'completionCode' tag 'code' and 'displayName' attributes shall match as per NCTIS: Admin
      Codes - Document Status.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </report>

  </rule>


  <rule context="/cda:ClinicalDocument/cda:versionNumber">

    <assert test="@value"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/versionNumber" -
      The 'versionNumber' tag 'value' attribute is missing.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

    <assert test="not(@value) or normalize-space(@value) != ''"
    >Error: Pharmacist Shared Medicines List - 5.1 Clinical Document -
      "ClinicalDocument/versionNumber" -
      The 'versionNumber' tag 'value' attribute shall contain a value.
      Refer to section 5.1 of the
      Core_Level_One_Clinical_Document_CDA_Implementation_Guide_v1.1.
    </assert>

  </rule>


</pattern>

