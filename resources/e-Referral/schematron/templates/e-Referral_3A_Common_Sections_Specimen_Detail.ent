

    <!-- COMMON SECTIONS TO SAMPLING PRECONDITIONS, COLLECTION SETTING,DATE TIME RECEIVED AND PARENT SPECIMEN IDENTIFIER - 0..1 -->

    <!-- /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section/cda:component/cda:section/cda:entry/cda:observation/cda:entryRelationship/cda:observation[cda:entryRelationship/cda:observation/cda:code/@code = '103.16171'] |
         /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section/cda:component/cda:section/cda:entry/cda:observation/cda:entryRelationship/cda:organizer/cda:component/cda:observation[cda:entryRelationship/cda:observation/cda:code/@code = '103.16171']">
    -->

    <!-- Status: Last Reviewed: 29/12/2011
         Status: Last Updated : 02/07/2012
    -->
    <!-- 02/07/2012 - Updated ALL the missing predicates - Mantis task 3739 -->

    <pattern name="p-e-Referral_3A_Common_Sections_Specimen_Detail-errors"
        id="p-e-Referral_3A_Common_Sections_Specimen_Detail-errors"
        see="#p-e-Referral_3A_Common_Sections_Specimen_Detail-errors">

        <!--Sampling Preconditions - 0..1-->

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:entryRelationship[cda:observation/cda:code/@code = '103.16171']] |
                       /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer[@classCode='BATTERY']/cda:component/cda:observation[cda:entryRelationship[cda:observation/cda:code/@code = '103.16171']] |
                       
                       /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:entryRelationship[cda:observation/cda:code/@code = '103.16529']] |
                       /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer[@classCode='BATTERY']/cda:component/cda:observation[cda:entryRelationship[cda:observation/cda:code/@code = '103.16529']] |
                       
                       /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:entryRelationship[cda:observation/cda:code/@code = '103.11014']] |
                       /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer[@classCode='BATTERY']/cda:component/cda:observation[cda:entryRelationship[cda:observation/cda:code/@code = '103.11014']] |
                      
                       /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:entryRelationship[cda:observation/cda:code/@code = '103.16187']] |
                       /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer[@classCode='BATTERY']/cda:component/cda:observation[cda:entryRelationship[cda:observation/cda:code/@code = '103.16187']]">

            <!--Sampling Preconditions - 0..1 - @code = '103.16171' -->

            <report
                test="count(cda:entryRelationship[cda:observation/cda:code/@code = '103.16171']) > 1"
                >Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Test
                Specimen Detail - "Result Group Specimen Detail / Collection and handling / Sampling
                Preconditions" and/or "Test Specimen Detail / Collection and handling / Sampling
                Preconditions" - The 'entryRelationship' tag shall appear only once for Sampling
                Preconditions. Refer to section 7.1.5.1.2.1 Result Group Specimen Detail and/or
                7.1.5.1.1 Test Specimen Detail of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>


            <!--Collection Setting - 0..1 - @code = '103.16529' -->

            <report
                test="count(cda:entryRelationship[cda:observation/cda:code/@code = '103.16529']) > 1"
                >Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Test
                Specimen Detail - "Test Specimen Detail / Handling and Processing / Collection
                Setting" and/or "Result Group Specimen Detail / Handling and Processing / Collection
                Setting" - The 'entryRelationship' tag shall appear only once for '@code =
                103.16529'. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>


            <!--DateTime Received - 0..1 - @code = '103.11014' -->

            <report
                test="count(cda:entryRelationship[cda:observation/cda:code/@code = '103.11014']) > 1"
                >Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Test
                Specimen Detail - "Test Specimen Detail / Handling and Processing / DateTime
                Received" and/or "Result Group Specimen Detail / Handling and Processing / DateTime
                Received" - The 'entryRelationship' tag shall appear only once for code =
                '103.11014'. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>


            <!--Parent Specimen Identifier - 0..1 - @code = '103.16187'-->

            <report
                test="count(cda:entryRelationship[cda:observation/cda:code/@code = '103.16187']) > 1"
                >Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Test
                Specimen Detail - "Test Specimen Detail / Identifiers / Parent Specimen Identifier"
                and/or "Result Group Specimen Detail / Identifiers / Parent Specimen Identifier" -
                The 'entryRelationship' tag shall appear only once for '@code = 103.16187'. Refer to
                sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>

        </rule>

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:observation/cda:code/@code = '103.16171'] |
                       /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer[@classCode='BATTERY']/cda:component/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:observation/cda:code/@code = '103.16171']">

            <!--entryRelationship-->

            <assert test="@typeCode = 'COMP'">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Result Group Specimen Detail /
                Collection and handling / Sampling Preconditions" and/or "Pathology Test Specimen
                Detail / Collection and handling / Sampling Preconditions" - The 'entryRelationship'
                tag 'typeCode' attribute shall contain the value 'COMP'. Refer to section
                7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Pathology Test Specimen
                Detail of the e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <!--observation-->

            <report test="count(cda:observation[cda:code/@code = '103.16171']) > 1">Error:
                e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Pathology
                Test Specimen Detail - "Result Group Specimen Detail / Collection and handling /
                Sampling Preconditions" and/or "Test Specimen Detail / Collection and handling /
                Sampling Preconditions" - The 'observation' tag shall appear only once for Sampling
                Preconditions. Refer to section 7.1.5.1.2.1 Result Group Specimen Detail and/or
                7.1.5.1.1 Test Specimen Detail of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>

        </rule>

        
<rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:code/@code = '103.16171'] |
               /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer[@classCode='BATTERY']/cda:component/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:code/@code = '103.16171']">


            <assert test="@classCode = 'OBS'">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Result Group Specimen Detail /
                Collection and handling / Sampling Preconditions" and/or "Pathology Test Specimen
                Detail / Collection and handling / Sampling Preconditions" - The 'observation' tag
                'classCode' attribute shall contain the value 'OBS'. Refer to section 7.1.5.1.2.1
                Result Group Specimen Detail and/or 7.1.5.1.1 Pathology Test Specimen Detail of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <assert test="@moodCode = 'EVN'">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Result Group Specimen Detail /
                Collection and handling / Sampling Preconditions" and/or "Pathology Test Specimen
                Detail / Collection and handling / Sampling Preconditions" - The 'observation' tag
                'moodCode' attribute shall contain the value 'EVN'. Refer to section 7.1.5.1.2.1
                Result Group Specimen Detail and/or 7.1.5.1.1 Pathology Test Specimen Detail of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <!--code-->

            <report test="count(cda:code) > 1">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Result Group Specimen Detail /
                Collection and handling / Sampling Preconditions" and/or "Pathology Test Specimen
                Detail / Collection and handling / Sampling Preconditions" - The 'code' tag shall
                appear only once. Refer to section 7.1.5.1.2.1 Result Group Specimen Detail and/or
                7.1.5.1.1 Test Specimen Detail of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>

            <!--value-->

            <assert test="cda:value">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail
                and/or 7.1.5.1.1 Test Specimen Detail - "Result Group Specimen Detail / Collection
                and handling / Sampling Preconditions" and/or "Pathology Test Specimen Detail /
                Collection and handling / Sampling Preconditions" - The 'value' tag is missing.
                Refer to section 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Test
                Specimen Detail of the e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <report test="count(cda:value) > 1">Error: e-Referral - 7.1.5.1.2.1 Result Group
                Specimen Detail and/or 7.1.5.1.1 Test Specimen Detail - "Result Group Specimen
                Detail / Collection and handling / Sampling Preconditions" and/or "Test Specimen
                Detail / Collection and handling / Sampling Preconditions" - The 'value' tag shall
                appear only once. Refer to section 7.1.5.1.2.1 Result Group Specimen Detail and/or
                7.1.5.1.1 Test Specimen Detail of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>
        </rule>

        <rule context="cda:code[@code = '103.16171']">

            <!--code-->

            <assert test="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation/cda:code[@code = '103.16171'] |
                          /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer[@classCode='BATTERY']/cda:component/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[@classCode='OBS']/cda:code[@code = '103.16171']"
                > Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Test
                Specimen Detail - "Result Group Specimen Detail / Collection and handling / Sampling
                Preconditions" and/or "Test Specimen Detail / Collection and handling / Sampling
                Preconditions" - 
                The /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry[observation/@classCode='OBS']/cda:observation/cda:entryRelationship/cda:observation/cda:entryRelationship/cda:observation/cda:code/@code = '103.16171' path or
                    /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry[observation/@classCode='OBS']/cda:observation/cda:entryRelationship[organizer/@classCode='BATTERY']/cda:organizer/cda:component/cda:observation/cda:entryRelationship/cda:observation/cda:code = '103.16171' path - 
                1 or more tags are missing. Refer to section 7.1.5.1.2.1
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>


            <assert test="@codeSystem = '1.2.36.1.2001.1001.101'"> Error: e-Referral - 7.1.5.1.2.1
                Result Group Specimen Detail and/or 7.1.5.1.1 Test Specimen Detail - "Result Group
                Specimen Detail / Collection and handling / Sampling Preconditions" and/or "Test
                Specimen Detail / Collection and handling / Sampling Preconditions" - The 'code' tag
                'codeSystem' attribute shall contain a value '1.2.36.1.2001.1001.101'. Refer to
                section 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Test Specimen
                Detail of the e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <assert
                test="translate(@codeSystemName, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'NCTIS DATA COMPONENTS'"
                > Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Test
                Specimen Detail - "Result Group Specimen Detail / Collection and handling / Sampling
                Preconditions" and/or "Test Specimen Detail / Collection and handling / Sampling
                Preconditions" - The 'code' tag 'codeSystemName' attribute shall contain the value
                'NCTIS Data Components'. Refer to section 7.1.5.1.2.1 Result Group Specimen Detail
                and/or 7.1.5.1.1 Test Specimen Detail of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <assert
                test="translate(@displayName, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'SAMPLING PRECONDITIONS'"
                > Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Test
                Specimen Detail - "Result Group Specimen Detail / Collection and handling / Sampling
                Preconditions" and/or "Test Specimen Detail / Collection and handling / Sampling
                Preconditions" - The 'code' tag 'displayName' attribute shall contain the value
                'Sampling Preconditions'. Refer to section 7.1.5.1.2.1 Result Group Specimen Detail
                and/or 7.1.5.1.1 Test Specimen Detail of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>

        </rule>

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:code/@code = '103.16171']/cda:value |
                       /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer/cda:component/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:code/@code = '103.16171']/cda:value">

            <!--value-->

            <assert test="@xsi:type">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail
                and/or 7.1.5.1.1 Test Specimen Detail - "Result Group Specimen Detail / Collection
                and handling / Sampling Preconditions" and/or "Pathology Test Specimen Detail /
                Collection and handling / Sampling Preconditions" - The 'value' tag 'xsi:type'
                attribute is missing. Check all 'observation' tags to find the missing attribute.
                Refer to sections 7.1.5.1.1, 7.1.5.1.2.1 of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <assert test="@xsi:type = 'CD'">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Result Group Specimen Detail /
                Collection and handling / Sampling Preconditions" and/or "Pathology Test Specimen
                Detail / Collection and handling / Sampling Preconditions" - The 'value' tag
                'xsi:type' attribute shall contain a value 'CD'. Check all 'observation' tags to
                update the attribute. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1 of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <!-- SV - Updated - 09/03/2012 - Mantis ID 2577 -->
            <assert
                test="cda:originalText or (@code and @codeSystem) or @nullFlavor or cda:translation"
                >Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Test
                Specimen Detail - "Result Group Specimen Detail / Collection and handling / Sampling
                Preconditions" and/or "Test Specimen Detail / Collection and handling / Sampling
                Preconditions" - The 'value' tag shall have an associated 'originalText' or
                'transalation' tag or 'code' and 'codeSystem' OR 'nullFlavor' attributes. Refer to
                sections 7.1.5.1.1, 7.1.5.1.2.1 of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <!-- <assert test="@codeSystem or @nullFlavor">Error: e-Referral - 7.1.5.1.2.1 Result Group
                Specimen Detail and/or 7.1.5.1.1 Test Specimen Detail - "Result Group Specimen
                Detail / Collection and handling / Sampling Preconditions" and/or "Test Specimen
                Detail / Collection and handling / Sampling Preconditions" - The 'value' tag shall
                have an associated 'codeSystem' OR 'nullFlavor' attribute. Check all 'observation'
                tags to find the missing attribute. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1 of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <assert test="cda:originalText or @code">Error: e-Referral - 7.1.5.1.2.1 Result Group
                Specimen Detail and/or 7.1.5.1.1 Test Specimen Detail - "Result Group Specimen
                Detail / Collection and handling / Sampling Preconditions" and/or "Test Specimen
                Detail / Collection and handling / Sampling Preconditions" - The 'originalText' tag
                is missing when no code attribute is provided. Refer to sections 7.1.5.1.1,
                7.1.5.1.2.1 of the e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <report test="@code and @nullFlavor">Error: e-Referral - 7.1.5.1.2.1 Result Group
                Specimen Detail and/or 7.1.5.1.1 Test Specimen Detail - "Result Group Specimen
                Detail / Collection and handling / Sampling Preconditions" and/or "Test Specimen
                Detail / Collection and handling / Sampling Preconditions" - The 'value' tag shall
                have an associated 'code' OR 'nullFlavor' attribute but not both. Check all
                'observation' tags to find the missing attribute. Refer to sections 7.1.5.1.1,
                7.1.5.1.2.1 of the e-Referral_CDA_Implementation_Guide_v2.2.</report>

            <report test="@codeSystem and @nullFlavor">Error: e-Referral - 7.1.5.1.2.1 Result Group
                Specimen Detail and/or 7.1.5.1.1 Test Specimen Detail - "Result Group Specimen
                Detail / Collection and handling / Sampling Preconditions" and/or "Test Specimen
                Detail / Collection and handling / Sampling Preconditions" - The 'value' tag shall
                have an associated 'codeSystem' OR 'nullFlavor' attribute but not both. Check all
                'observation' tags to find the missing attribute. Refer to sections 7.1.5.1.1,
                7.1.5.1.2.1 of the e-Referral_CDA_Implementation_Guide_v2.2.</report>-->

            <!--End of SV's - Update - 09/03/2012 - Mantis ID 2577 -->

            <report test="@code and normalize-space(@code) = ''">Error: e-Referral - 7.1.5.1.2.1
                Result Group Specimen Detail and/or 7.1.5.1.1 Test Specimen Detail - "Result Group
                Specimen Detail / Collection and handling / Sampling Preconditions" and/or "Test
                Specimen Detail / Collection and handling / Sampling Preconditions" - The 'value'
                tag 'code' attribute shall contain a value. Check all 'cda:value' tags 'code'
                attributes to find the error. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>

            <report test="@codeSystem and normalize-space(@codeSystem) = ''">Error: e-Referral -
                7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Pathology Test Specimen
                Detail - "Result Group Specimen Detail / Collection and handling / Sampling
                Preconditions" and/or "Test Specimen Detail / Collection and handling / Sampling
                Preconditions" - The 'value' tag 'codeSystem' attribute shall contain a value. Check
                all 'cda:value' tags 'codeSystem' attributes to find the error. Refer to sections
                7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>

            <report test="@codeSystemName and normalize-space(@codeSystemName) = ''">Error:
                e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Pathology
                Test Specimen Detail - "Result Group Specimen Detail / Collection and handling /
                Sampling Preconditions" and/or "Test Specimen Detail / Collection and handling /
                Sampling Preconditions" - The 'value' tag 'codeSystemName' attribute shall contain a
                value. Check all 'cda:value' tags 'codeSystemName' attributes to find the error.
                Refer to sections 7.1.5.1.1, 7.1.5.1.2.1 of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>

            <report test="@displayName and normalize-space(@displayName) = ''">Error: e-Referral -
                7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Pathology Test Specimen
                Detail - "Result Group Specimen Detail / Collection and handling / Sampling
                Preconditions" and/or "Test Specimen Detail / Collection and handling / Sampling
                Preconditions" - The 'value' tag 'displayName' attribute shall contain a value.
                Check all 'cda:value' tags 'displayName' attributes to find the error. Refer to
                sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>

            <report test="cda:originalText and normalize-space(cda:originalText) = ''">Error:
                e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Pathology
                Test Specimen Detail - "Result Group Specimen Detail / Collection and handling /
                Sampling Preconditions" and/or "Test Specimen Detail / Collection and handling /
                Sampling Preconditions" - The 'originalText' tag shall contain a
                value. Check all 'cda:value' tags 'originalText' tags to find the error. Refer
                to sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>

            <!--Updated UC - Mantis Task - 2629-->

            <report test="count(cda:originalText) > 1">Error: e-Referral - 7.1.5.1.2.1 Result Group
                Specimen Detail and/or 7.1.5.1.1 Pathology Test Specimen Detail - "Result Group
                Specimen Detail / Collection and handling / Sampling Preconditions" and/or "Test
                Specimen Detail / Collection and handling / Sampling Preconditions" - The
                'originalText' tag shall appear only once. Check all 'value/cda:originalText' tags
                to find the missing text. Refer to section 8.1 of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>

            <!--End update UC - Mantis Task - 2629-->

            <report test="cda:translation and normalize-space(cda:translation) = ''">Error:
                e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Pathology
                Test Specimen Detail - "Result Group Specimen Detail / Collection and handling /
                Sampling Preconditions" and/or "Test Specimen Detail / Collection and handling /
                Sampling Preconditions" - The 'translation' tag shall contain a
                value. Check all 'cda:value/cda:translation' tags to find the error. Refer
                to sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>

        </rule>


        <!--Collection Setting - 0..1 -->

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:observation/cda:code/@code = '103.16529'] |
                       /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer[@classCode='BATTERY']/cda:component/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:observation/cda:code/@code = '103.16529']">

            <assert test="@typeCode = 'COMP'">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Pathology Test Specimen Detail /
                Handling and Processing / Collection Setting" and/or "Result Group Specimen Detail /
                Handling and Processing / Collection Setting" - The 'entryRelationship' tag
                'typeCode' attribute shall contain the value 'COMP'. Refer to sections 7.1.5.1.1,
                7.1.5.1.2.1, of the e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <report test="count(cda:observation) > 1">Error: e-Referral - 7.1.5.1.2.1 Result Group
                Specimen Detail and/or 7.1.5.1.1 Test Specimen Detail - "Pathology Test Specimen
                Detail / Handling and Processing / Collection Setting" and/or "Result Group Specimen
                Detail / Handling and Processing / Collection Setting" - The 'observation' tag shall
                appear only once for '@code = 103.16529'. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1,
                of the e-Referral_CDA_Implementation_Guide_v2.2.</report>

        </rule>

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:code/@code = '103.16529'] |
                       /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer[@classCode='BATTERY']/cda:component/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:code/@code = '103.16529']">

            <assert test="@classCode = 'OBS'">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Pathology Test Specimen Detail /
                Handling and Processing / Collection Setting" and/or "Result Group Specimen Detail /
                Handling and Processing / Collection Setting" - The 'observation' tag 'classCode'
                attribute shall contain the value 'OBS'. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1,
                of the e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <assert test="@moodCode = 'EVN'">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Pathology Test Specimen Detail /
                Handling and Processing / Collection Setting" and/or "Result Group Specimen Detail /
                Handling and Processing / Collection Setting" - The 'observation' tag 'moodCode'
                attribute shall contain the value 'EVN'. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1,
                of the e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <report test="count(cda:code) > 1">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Pathology Test Specimen Detail /
                Handling and Processing / Collection Setting" and/or "Result Group Specimen Detail /
                Handling and Processing / Collection Setting" - The 'code' tag shall appear only
                once. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>

            <!--Commented out due to changes in IG, from text to value.-->
            <!--<assert test="cda:text">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail
                and/or 7.1.5.1.1 Test Specimen Detail - "Test Specimen Detail /
                Handling and Processing / Collection Setting" and/or "Result Group Specimen Detail /
                Handling and Processing / Collection Setting" - The 'text' tag is missing. Refer to
                sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>
                
                <assert test="normalize-space(cda:text) !=  ''">Error: e-Referral - 7.1.5.1.2.1 Result
                Group Specimen Detail and/or 7.1.5.1.1 Test Specimen Detail - "Pathology
                Test Specimen Detail / Handling and Processing / Collection Setting" and/or "Result
                Group Specimen Detail / Handling and Processing / Collection Setting" - The 'text'
                tag shall contain a value. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>-->

            <!--Add new tests due to changes in IG, from text to value.-->
            <assert test="cda:value">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail
                and/or 7.1.5.1.1 Test Specimen Detail - "Test Specimen Detail / Handling and
                Processing / Collection Setting" and/or "Result Group Specimen Detail / Handling and
                Processing / Collection Setting" - The 'value' tag is missing. Refer to sections
                7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <assert test="normalize-space(cda:value) !=  ''">Error: e-Referral - 7.1.5.1.2.1 Result
                Group Specimen Detail and/or 7.1.5.1.1 Test Specimen Detail - "Pathology Test
                Specimen Detail / Handling and Processing / Collection Setting" and/or "Result Group
                Specimen Detail / Handling and Processing / Collection Setting" - The 'value' tag
                shall contain a value. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>




        </rule>

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:code/@code = '103.16529']/cda:value |
                       /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer[@classCode='BATTERY']/cda:component/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:code/@code = '103.16529']/cda:value">

            <assert test="@xsi:type">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail
                and/or 7.1.5.1.1 Test Specimen Detail - "Test Specimen Detail / Handling and
                Processing / Collection Setting" and/or "Result Group Specimen Detail / Handling and
                Processing / Collection Setting" - The 'value' tag 'xsi:type' attribute is missing.
                Refer to sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <assert test="@xsi:type='ST'">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Test Specimen Detail / Handling and
                Processing / Collection Setting" and/or "Result Group Specimen Detail / Handling and
                Processing / Collection Setting" - The 'xsi:type' attribute shall contain the value
                'ST'. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>


        </rule>

        <rule context="cda:code[@code = '103.16529']">

            <assert test="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:code/@code = '103.16529'] |
                          /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer[@classCode='BATTERY']/cda:component/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:code/@code = '103.16529']"
                > Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail - 
                The /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[code/@code = '101.20117']/cda:component/cda:section[code/@code = '102.16144']/cda:entry[observation/@classCode='OBS']/cda:observation/cda:entryRelationship/cda:observation/cda:entryRelationship/cda:observation/cda:code/@code = '103.16529' path or
                    /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[code/@code = '101.20117']/cda:component/cda:section[code/@code = '102.16144']/cda:entry[observation/@classCode='OBS']/cda:observation/cda:entryRelationship[organizer/@classCode='BATTERY']/cda:organizer/cda:component/cda:observation/cda:entryRelationship/cda:observation/cda:code = '103.16529' path - 
                1 or more tags are missing. Refer to section 7.1.5.1.2.1 Result
                Group Specimen Detail and/or 7.1.5.1.1 Test Specimen Detail of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>


            <assert test="@codeSystem = '1.2.36.1.2001.1001.101'">Error: e-Referral - 7.1.5.1.2.1
                Result Group Specimen Detail and/or 7.1.5.1.1 Test Specimen Detail - "Test Specimen
                Detail / Handling and Processing / Collection Setting" and/or "Result Group Specimen
                Detail / Handling and Processing / Collection Setting" - The 'code' tag 'codeSystem'
                attribute shall contain the value '1.2.36.1.2001.1001.101'. Refer to section
                7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Pathology Test Specimen
                Detail of the e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <assert
                test="translate(@codeSystemName, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'NCTIS DATA COMPONENTS'"
                >Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Test
                Specimen Detail - "Test Specimen Detail / Handling and Processing / Collection
                Setting" and/or "Result Group Specimen Detail / Handling and Processing / Collection
                Setting" - The 'code' tag 'codeSystemName' attribute shall contain a value 'NCTIS
                Data Components'. Refer to section 7.1.5.1.2.1 Result Group Specimen Detail and/or
                7.1.5.1.1 Test Specimen Detail of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <assert
                test="translate(@displayName, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'COLLECTION SETTING'"
                >Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Test
                Specimen Detail - "Test Specimen Detail / Handling and Processing / Collection
                Setting" and/or "Result Group Specimen Detail / Handling and Processing / Collection
                Setting"- The 'code' tag 'displayName' attribute shall contain a value 'Collection
                Setting'. Refer to section 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1
                Test Specimen Detail of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>


        </rule>


        <!--DateTime Received - 0..1-->

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:observation/cda:code/@code = '103.11014'] |
                       /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer[@classCode='BATTERY']/cda:component/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:observation/cda:code/@code = '103.11014']">

            <assert test="@typeCode = 'COMP'">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Pathology Test Specimen Detail /
                Handling and Processing / DateTime Received" and/or "Result Group Specimen Detail /
                Handling and Processing / DateTime Received" - The 'entryRelationship' tag
                'typeCode' attribute shall contain the value 'COMP'. Refer to sections 7.1.5.1.1,
                7.1.5.1.2.1, of the e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <report test="count(cda:observation[cda:code/@code = '103.11014']) > 1">Error:
                e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Pathology
                Test Specimen Detail - "Test Specimen Detail / Handling and Processing / DateTime
                Received" and/or "Result Group Specimen Detail / Handling and Processing / DateTime
                Received" - The 'observation' tag shall appear only once for code = '103.11014'.
                Refer to sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>

        </rule>

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:code/@code = '103.11014'] |
                       /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer[@classCode='BATTERY']/cda:component/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:code/@code = '103.11014']">

            <assert test="@classCode = 'OBS'">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Pathology Test Specimen Detail /
                Handling and Processing / DateTime Received" and/or "Result Group Specimen Detail /
                Handling and Processing / DateTime Received" - The 'observation' tag 'classCode'
                attribute shall contain the value 'OBS'. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1,
                of the e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <assert test="@moodCode = 'EVN'">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Pathology Test Specimen Detail /
                Handling and Processing / DateTime Received" and/or "Result Group Specimen Detail /
                Handling and Processing / DateTime Received" - The 'observation' tag 'moodCode'
                attribute shall contain the value 'EVN'. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1,
                of the e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <report test="count(cda:code) > 1">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Pathology Test Specimen Detail /
                Handling and Processing / DateTime Received" and/or "Result Group Specimen Detail /
                Handling and Processing / DateTime Received" - The 'code' tag shall appear only
                once. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>

            <!--Below is commented out because of changes in new IG, from effectiveTime to value.-->
            <!--<assert test="cda:effectiveTime">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Pathology Test Specimen
                Detail / Handling and Processing / DateTime Received" and/or "Result Group Specimen
                Detail / Handling and Processing / DateTime Received" - The 'effectiveTime' tag is
                missing. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <report test="count(cda:effectiveTime) > 1">Error: e-Referral - 7.1.5.1.2.1 Result Group
                Specimen Detail and/or 7.1.5.1.1 Test Specimen Detail - "Pathology Test
                Specimen Detail / Handling and Processing / DateTime Received" and/or "Result Group
                Specimen Detail / Handling and Processing / DateTime Received" - The 'effectiveTime'
                tag shall appear only once. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>-->

            <assert test="cda:value">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail
                and/or 7.1.5.1.1 Test Specimen Detail - "Pathology Test Specimen Detail / Handling
                and Processing / DateTime Received" and/or "Result Group Specimen Detail / Handling
                and Processing / DateTime Received" - The 'value' tag is missing. Refer to sections
                7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <report test="count(cda:value) > 1">Error: e-Referral - 7.1.5.1.2.1 Result Group
                Specimen Detail and/or 7.1.5.1.1 Test Specimen Detail - "Pathology Test Specimen
                Detail / Handling and Processing / DateTime Received" and/or "Result Group Specimen
                Detail / Handling and Processing / DateTime Received" - The 'value' tag shall appear
                only once. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>

        </rule>

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:code/@code = '103.11014']/cda:value |
                       /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer[@classCode='BATTERY']/cda:component/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:code/@code = '103.11014']/cda:value">


            <assert test="@xsi:type">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail
                and/or 7.1.5.1.1 Test Specimen Detail - "Pathology Test Specimen Detail / Handling
                and Processing / DateTime Received" and/or "Result Group Specimen Detail / Handling
                and Processing / DateTime Received" - The 'value' tag 'xsi:type' attribute is
                missing. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <assert test="@xsi:type='TS'">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Pathology Test Specimen Detail /
                Handling and Processing / DateTime Received" and/or "Result Group Specimen Detail /
                Handling and Processing / DateTime Received" - The 'value' tag 'xsi:type' attribute
                shall be 'TS'. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>


        </rule>


        <!--Specimen Identifier - 0..1-->

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:entryRelationship/cda:observation[@classCode='OBS']/cda:code/@code = '103.11014']/cda:specimen/cda:specimenRole |
                       /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer[@classCode='BATTERY']/cda:component/cda:observation[cda:entryRelationship/cda:observation/cda:code/@code = '103.11014']/cda:specimen/cda:specimenRole">


            <report test="count(cda:id) > 1">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Test Specimen Detail / Identifiers /
                Specimen Identifier" and/or "Result Group Specimen Detail / Identifiers / Specimen
                Identifier" - The 'id' tag shall appear only once. Refer to section 7.1.5.1.2.1
                Result Group Specimen Detail and/or 7.1.5.1.1 Pathology Test Specimen Detail of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>

        </rule>

        <rule context="cda:code[@code = '103.11014']">

            <assert test="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:code/@code = '103.11014'] |
                          /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer[@classCode='BATTERY']/cda:component/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:code/@code = '103.11014']"
                > Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Test
                Specimen Detail - "Test Specimen Detail / Identifiers / Container Identifier" and/or
                "Result Group Specimen Detail / Identifiers / Container Identifier"- 
                The /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[code/@code = '101.20117']/cda:component/cda:section[code/@code = '102.16144']/cda:entry[observation/@classCode='OBS']/cda:observation/cda:entryRelationship/cda:observation/cda:entryRelationship/cda:observation/cda:code/@code = '103.11014' path or
                    /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[code/@code = '101.20117']/cda:component/cda:section[code/@code = '102.16144']/cda:entry[observation/@classCode='OBS']/cda:observation/cda:entryRelationship[organizer/@classCode='BATTERY']/cda:organizer/cda:component/cda:observation/cda:entryRelationship/cda:observation/cda:code = '103.11014' path - 
                1 or more tags are missing. Refer to section 7.1.5.1.2.1 Result
                Group Specimen Detail and/or 7.1.5.1.1 Test Specimen Detail of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>


            <assert test="@codeSystem = '1.2.36.1.2001.1001.101'">Error: e-Referral - 7.1.5.1.2.1
                Result Group Specimen Detail and/or 7.1.5.1.1 Test Specimen Detail - "Result Group
                Specimen Detail / Handling and Processing / DateTime Received" and/or "Result Group
                Specimen Detail / Handling and Processing / DateTime Received" - The 'code' tag
                'codeSystem' attribute shall contain the value '1.2.36.1.2001.1001.101'. Refer to
                section 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Pathology Test
                Specimen Detail of the e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <assert
                test="translate(@codeSystemName, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'NCTIS DATA COMPONENTS'"
                >Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Test
                Specimen Detail - "Result Group Specimen Detail / Handling and Processing / DateTime
                Received" and/or "Result Group Specimen Detail / Handling and Processing / DateTime
                Received" - The 'code' tag 'codeSystemName' attribute shall contain a value 'NCTIS
                Data Components'. Refer to section 7.1.5.1.2.1 Result Group Specimen Detail and/or
                7.1.5.1.1 Test Specimen Detail of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <assert
                test="translate(@displayName, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'DATETIME RECEIVED'"
                >Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Test
                Specimen Detail - "Result Group Specimen Detail / Handling and Processing / DateTime
                Received" and/or "Result Group Specimen Detail / Handling and Processing / DateTime
                Received"- The 'code' tag 'displayName' attribute shall contain a value 'DateTime
                Received'. Refer to section 7.1.5.1.2.1 Result Group Specimen Detail and/or
                7.1.5.1.1 Test Specimen Detail of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>


        </rule>


        <!--Parent Specimen Identifier - 0..1-->

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:observation/cda:code/@code = '103.16187'] |
                       /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer[@classCode='BATTERY']/cda:component/cda:observation[@classCode='OBS']/cda:entryRelationship[cda:observation/cda:code/@code = '103.16187']">


            <assert test="@typeCode = 'COMP'">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Pathology Test Specimen Detail /
                Identifiers / Parent Specimen Identifier" and/or "Result Group Specimen Detail /
                Identifiers / Parent Specimen Identifier" - The 'entryRelationship' tag 'typeCode'
                attribute shall contain the value 'COMP'. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1,
                of the e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <report test="count(cda:observation[cda:code/@code = '103.16187']) > 1">Error:
                e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Pathology
                Test Specimen Detail - "Test Specimen Detail / Identifiers / Parent Specimen
                Identifier" and/or "Result Group Specimen Detail / Identifiers / Parent Specimen
                Identifier" - The 'observation' tag shall appear only once for '@code = 103.16187'.
                Refer to sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>

        </rule>

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:code/@code = '103.16187'] |
                       /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer[@classCode='BATTERY']/cda:component/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:code/@code = '103.16187']">


            <assert test="@classCode = 'OBS'">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Pathology Test Specimen Detail /
                Identifiers / Parent Specimen Identifier" and/or "Result Group Specimen Detail /
                Identifiers / Parent Specimen Identifier" - The 'observation' tag 'classCode'
                attribute shall contain the value 'OBS'. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1,
                of the e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <assert test="@moodCode = 'EVN'">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Pathology Test Specimen Detail /
                Identifiers / Parent Specimen Identifier" and/or "Result Group Specimen Detail /
                Identifiers / Parent Specimen Identifier" - The 'observation' tag 'moodCode'
                attribute shall contain the value 'EVN'. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1,
                of the e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <report test="count(cda:code) > 1">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Pathology Test Specimen Detail /
                Identifiers / Parent Specimen Identifier" and/or "Result Group Specimen Detail /
                Identifiers / Parent Specimen Identifier" - The 'code' tag shall appear only once.
                Refer to sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>

            <assert test="cda:specimen">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail
                and/or 7.1.5.1.1 Test Specimen Detail - "Test Specimen Detail / Identifiers / Parent
                Specimen Identifier" and/or "Result Group Specimen Detail / Identifiers / Parent
                Specimen Identifier" - The 'specimen' tag is missing. Refer to sections 7.1.5.1.1,
                7.1.5.1.2.1, of the e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <report test="count(cda:specimen) > 1">Error: e-Referral - 7.1.5.1.2.1 Result Group
                Specimen Detail and/or 7.1.5.1.1 Test Specimen Detail - "Pathology Test Specimen
                Detail / Identifiers / Parent Specimen Identifier" and/or "Result Group Specimen
                Detail / Identifiers / Parent Specimen Identifier" - The 'specimen' tag shall appear
                only once. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>

        </rule>

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:code/@code = '103.16187']/cda:specimen |
                       /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer[@classCode='BATTERY']/cda:component/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:code/@code = '103.16187']/cda:specimen">


            <assert test="cda:specimenRole">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Pathology Test Specimen Detail /
                Identifiers / Parent Specimen Identifier" and/or "Result Group Specimen Detail /
                Identifiers / Parent Specimen Identifier" - The 'specimenRole' tag is missing. Refer
                to sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <report test="count(cda:specimenRole) > 1">Error: e-Referral - 7.1.5.1.2.1 Result Group
                Specimen Detail and/or 7.1.5.1.1 Test Specimen Detail - "Pathology Test Specimen
                Detail / Identifiers / Parent Specimen Identifier" and/or "Result Group Specimen
                Detail / Identifiers / Parent Specimen Identifier" - The 'specimenRole' tag shall
                appear only once. Refer to sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>

        </rule>

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:code/@code = '103.16187']/cda:specimen/cda:specimenRole |
                       /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer[@classCode='BATTERY']/cda:component/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:code/@code = '103.16187']/cda:specimen/cda:specimenRole">


            <assert test="cda:id">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail
                and/or 7.1.5.1.1 Test Specimen Detail - "Test Specimen Detail / Identifiers / Parent
                Specimen Identifier" and/or "Result Group Specimen Detail / Identifiers / Parent
                Specimen Identifier" - The 'id' tag is missing. Refer to sections 7.1.5.1.1,
                7.1.5.1.2.1, of the e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <report test="count(cda:id) > 1">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Pathology Test Specimen Detail /
                Identifiers / Parent Specimen Identifier" and/or "Result Group Specimen Detail /
                Identifiers / Parent Specimen Identifier" - The 'id' tag shall appear only once.
                Refer to sections 7.1.5.1.1, 7.1.5.1.2.1, of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>

        </rule>

        <rule context="cda:code[@code = '103.16187']">

            <assert test="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:code/@code = '103.16187'] |
                          /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer[@classCode='BATTERY']/cda:component/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:code/@code = '103.16187']"
                > Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Test
                Specimen Detail - "Test Specimen Detail / Handling and Processing / DateTime
                Received" and/or "Result Group Specimen Detail / Handling and Processing / DateTime
                Received" - 
                The /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[code/@code = '101.20117']/cda:component/cda:section[code/@code = '102.16144']/cda:entry/cda:observation/cda:entryRelationship/cda:observation/cda:entryRelationship/cda:observation/cda:code/@code = '103.16187' path or
                    /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[code/@code = '101.20117']/cda:component/cda:section[code/@code = '102.16144']/cda:entry/cda:observation/cda:entryRelationship[organizer/@classCode='BATTERY']/cda:organizer/cda:component/cda:observation/cda:entryRelationship/cda:observation/cda:code = '103.16187' path - 
                1 or more tags are missing. Refer to section 7.1.5.1.2.1 Result
                Group Specimen Detail and/or 7.1.5.1.1 Test Specimen Detail of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <assert test="@codeSystem = '1.2.36.1.2001.1001.101'">Error: e-Referral - 7.1.5.1.2.1
                Result Group Specimen Detail and/or 7.1.5.1.1 Test Specimen Detail - "Test Specimen
                Detail / Handling and Processing / DateTime Received" and/or "Result Group Specimen
                Detail / Handling and Processing / DateTime Received" - The 'code' tag 'codeSystem'
                attribute shall contain the value '1.2.36.1.2001.1001.101'. Refer to section
                7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Pathology Test Specimen
                Detail of the e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <assert
                test="translate(@codeSystemName, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'NCTIS DATA COMPONENTS'"
                >Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Test
                Specimen Detail - "Test Specimen Detail / Handling and Processing / DateTime
                Received" and/or "Result Group Specimen Detail / Handling and Processing / DateTime
                Received" - The 'code' tag 'codeSystemName' attribute shall contain a value 'NCTIS
                Data Components'. Refer to section 7.1.5.1.2.1 Result Group Specimen Detail and/or
                7.1.5.1.1 Test Specimen Detail of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <assert
                test="translate(@displayName, 'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') = 'PARENT SPECIMEN IDENTIFIER'"
                >Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Test
                Specimen Detail - "Test Specimen Detail / Handling and Processing / DateTime
                Received" and/or "Result Group Specimen Detail / Handling and Processing / DateTime
                Received"- The 'code' tag 'displayName' attribute shall contain a value 'Parent
                Specimen Identifier'. Refer to section 7.1.5.1.2.1 Result Group Specimen Detail
                and/or 7.1.5.1.1 Test Specimen Detail of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>


        </rule>


        <!--Container Identifier - 0..1-->

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:entryRelationship/cda:observation/cda:code/@code = '103.11014']/cda:specimen/cda:specimenRole/cda:specimenPlayingEntity |
                       /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer[@classCode='BATTERY']/cda:component/cda:observation[cda:entryRelationship/cda:observation/cda:code/@code = '103.11014']/cda:specimen/cda:specimenRole/cda:specimenPlayingEntity">


            <report test="count(ext:asSpecimenInContainer) > 1">Error: e-Referral - 7.1.5.1.2.1
                Result Group Specimen Detail and/or 7.1.5.1.1 Test Specimen Detail - "Test Specimen
                Detail / Identifiers / Container Identifier" and/or "Result Group Specimen Detail /
                Identifiers / Container Identifier" - The 'asSpecimenInContainer' tag shall appear
                only once. Refer to section 7.1.5.1.2.1 Result Group Specimen Detail and/or
                7.1.5.1.1 Pathology Test Specimen Detail of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>

        </rule>

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:entryRelationship/cda:observation/cda:code/@code = '103.11014']/cda:specimen/cda:specimenRole/cda:specimenPlayingEntity/ext:asSpecimenInContainer |
                       /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer[@classCode='BATTERY']/cda:component/cda:observation[cda:entryRelationship/cda:observation/cda:code/@code = '103.11014']/cda:specimen/cda:specimenRole/cda:specimenPlayingEntity/ext:asSpecimenInContainer">


            <assert test="@classCode = 'CONT'">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Test Specimen Detail / Identifiers /
                Container Identifier" and/or "Result Group Specimen Detail / Identifiers / Container
                Identifier" - The 'asSpecimenInContainer' tag 'classCode' attribute shall be 'CONT'.
                Refer to section 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Pathology
                Test Specimen Detail of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <assert test="ext:container">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Pathology Test Specimen Detail - "Test Specimen Detail /
                Identifiers / Container Identifier" and/or "Result Group Specimen Detail /
                Identifiers / Container Identifier"- The 'container' tag is missing. Refer to
                section 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Test Specimen
                Detail of the e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <report test="count(ext:container) > 1">Error: e-Referral - 7.1.5.1.2.1 Result Group
                Specimen Detail and/or 7.1.5.1.1 Test Specimen Detail - "Test Specimen Detail /
                Identifiers / Container Identifier" and/or "Result Group Specimen Detail /
                Identifiers / Container Identifier"- The 'container' tag shall appear only once.
                Refer to section 7.1.5.1.2.1 Result Group Specimen Detail and/or 7.1.5.1.1 Test
                Specimen Detail of the e-Referral_CDA_Implementation_Guide_v2.2.</report>

        </rule>

        <rule context="/cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:observation[cda:entryRelationship/cda:observation/cda:code/@code = '103.11014']/cda:specimen/cda:specimenRole/cda:specimenPlayingEntity/ext:asSpecimenInContainer/ext:container |
                       /cda:ClinicalDocument/cda:component/cda:structuredBody/cda:component/cda:section[cda:code/@code = '101.20117']/cda:component/cda:section[cda:code/@code = '102.16144']/cda:entry/cda:observation[@classCode='OBS']/cda:entryRelationship/cda:organizer[@classCode='BATTERY']/cda:component/cda:observation[cda:entryRelationship/cda:observation/cda:code/@code = '103.11014']/cda:specimen/cda:specimenRole/cda:specimenPlayingEntity/ext:asSpecimenInContainer/ext:container">


            <assert test="ext:id">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen Detail
                and/or 7.1.5.1.1 Test Specimen Detail - "Test Specimen Detail / Identifiers /
                Container Identifier" and/or "Result Group Specimen Detail / Identifiers / Container
                Identifier"- The 'id' tag is missing. Refer to section 7.1.5.1.2.1 Result Group
                Specimen Detail and/or 7.1.5.1.1 Test Specimen Detail of the
                e-Referral_CDA_Implementation_Guide_v2.2.</assert>

            <report test="count(ext:id) > 1">Error: e-Referral - 7.1.5.1.2.1 Result Group Specimen
                Detail and/or 7.1.5.1.1 Test Specimen Detail - "Test Specimen Detail / Identifiers /
                Container Identifier" and/or "Result Group Specimen Detail / Identifiers / Container
                Identifier"- The 'id' tag shall appear only once. Refer to section 7.1.5.1.2.1
                Result Group Specimen Detail and/or 7.1.5.1.1 Test Specimen Detail of the
                e-Referral_CDA_Implementation_Guide_v2.2.</report>

        </rule>


    </pattern>

